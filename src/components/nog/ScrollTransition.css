/* src/components/nog/ScrollTransition.css */

.scroll-transition-container {
  position: relative;
  width: 100%;
  height: 200vh; /* Double hauteur pour permettre le scroll */
}

.content-layer {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100vh;
  opacity: var(--layer-opacity, 0);
  transition: opacity 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  will-change: opacity;
}

.home-layer {
  z-index: 1;
  position: sticky;
  filter: var(--layer-filter, none);
}

/* Contrôle spécifique des textes et animations de la page d'accueil */
.home-layer * {
  opacity: var(--text-opacity, 1);
  transition: opacity 0.8s ease-out;
}

/* Réduction progressive de l'intensité des animations */
.home-layer [data-animation],
.home-layer .animated-element,
.home-layer .hero-animation {
  transform: scale(var(--animation-intensity, 1));
  opacity: calc(var(--text-opacity, 1) * var(--animation-intensity, 1));
  filter: blur(calc((1 - var(--animation-intensity, 1)) * 3px));
  transition: transform 1s ease-out, opacity 0.8s ease-out, filter 1s ease-out;
}

.nog-layer {
  z-index: 2;
  position: absolute;
  top: 100vh; /* Positionnée juste en dessous */
  /* Transition finale vers opacité complète */
  background: linear-gradient(
    to bottom,
    rgba(255, 255, 255, 0) 0%,
    rgba(255, 255, 255, 0.7) 5%,
    rgba(255, 255, 255, 0.95) 15%,
    #ffffff 25%
  );
  /* Mélange progressif avec transition vers opacité totale */
  mask: linear-gradient(
    to bottom, 
    transparent calc(var(--blend-offset, 0%) - 30%),
    rgba(255, 255, 255, 0.2) calc(var(--blend-offset, 0%) - 15%),
    rgba(255, 255, 255, 0.8) calc(var(--blend-offset, 0%) + 5%),
    white calc(var(--blend-offset, 0%) + 20%)
  );
  -webkit-mask: linear-gradient(
    to bottom, 
    transparent calc(var(--blend-offset, 0%) - 30%),
    rgba(255, 255, 255, 0.2) calc(var(--blend-offset, 0%) - 15%),
    rgba(255, 255, 255, 0.8) calc(var(--blend-offset, 0%) + 5%),
    white calc(var(--blend-offset, 0%) + 20%)
  );
}

/* Assure que la section NOG soit complètement opaque quand visible */
.nog-layer[style*="--layer-opacity: 1"],
.nog-layer.fully-visible {
  background: #ffffff;
  mask: none;
  -webkit-mask: none;
}

/* Animation de scroll fluide */
@keyframes smoothReveal {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.nog-layer > * {
  animation: smoothReveal 1.2s ease-out forwards;
  animation-delay: 0.3s;
  opacity: 0;
}

/* Optimisations de performance */
.scroll-transition-container {
  contain: layout style paint;
}

.content-layer {
  backface-visibility: hidden;
  transform: translateZ(0);
}

/* Media queries pour les animations réduites */
@media (prefers-reduced-motion: reduce) {
  .content-layer {
    transition: none;
    transform: none;
    filter: none !important;
    mask: none !important;
    -webkit-mask: none !important;
  }
  
  .home-layer {
    opacity: 1;
  }
  
  .home-layer * {
    opacity: 1 !important;
    transition: none;
  }
  
  .nog-layer {
    opacity: 1;
    background: #ffffff;
    top: 100vh;
    mask: none !important;
    -webkit-mask: none !important;
  }
  
  .nog-layer > * {
    animation: none;
    opacity: 1;
  }
}

/* Mobile optimizations */
@media (max-width: 768px) {
  .scroll-transition-container {
    height: 180vh;
  }
  
  .nog-layer {
    background: linear-gradient(
      to bottom,
      rgba(255, 255, 255, 0) 0%,
      rgba(255, 255, 255, 0.9) 15%,
      #ffffff 25%
    );
  }
}

/* Fallback pour les navigateurs sans support mask */
@supports not (mask: linear-gradient(to bottom, transparent, white)) {
  .nog-layer {
    mask: none;
    -webkit-mask: none;
    background: linear-gradient(
      to bottom,
      rgba(255, 255, 255, 0) 0%,
      rgba(255, 255, 255, 0.5) 10%,
      rgba(255, 255, 255, 0.8) 20%,
      rgba(255, 255, 255, 0.95) 30%,
      #ffffff 40%
    );
  }
  
  .nog-layer[style*="--layer-opacity: 1"] {
    background: #ffffff;
  }
}
